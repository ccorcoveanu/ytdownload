{"version":3,"sources":["app.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","_search","_search2","App","this","initMaterial","search","value","./modules/search","2","Search","searchText","searchInput","document","querySelector","searchButton","state","isSearching","onChange","bind","getPlaylist","getVideo","validateUrl","attachEvents","addEventListener","text","urlObj","type","url","console","log","indexOf","video_id","getParamByNameFromUrlString","id","_video_id","name","replace","regex","RegExp","results","exec","decodeURIComponent"],"mappings":"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","file":"../app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _search = require('./modules/search');\n\nvar _search2 = _interopRequireDefault(_search);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar App = function () {\n  function App() {\n    _classCallCheck(this, App);\n\n    this.initMaterial();\n    this.search = new _search2.default();\n  }\n\n  _createClass(App, [{\n    key: 'initMaterial',\n    value: function initMaterial() {\n      //return $.material.init();\n    }\n  }]);\n\n  return App;\n}();\n\nnew App();\n\n},{\"./modules/search\":2}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Search = function () {\n  function Search() {\n    _classCallCheck(this, Search);\n\n    this.searchText = '';\n    this.searchInput = document.querySelector('.js-searchbox__textfield');\n    this.searchButton = document.querySelector('.js-search__button');\n\n    this.state = {};\n    this.isSearching = false;\n\n    this.onChange = this.onChange.bind(this);\n    this.getPlaylist = this.getPlaylist.bind(this);\n    this.getVideo = this.getVideo.bind(this);\n    this.validateUrl = this.validateUrl.bind(this);\n\n    this.attachEvents();\n  }\n\n  _createClass(Search, [{\n    key: 'attachEvents',\n    value: function attachEvents() {\n      this.searchInput.addEventListener('keyup', this.onChange);\n      this.searchButton.addEventListener('click', this.onChange);\n    }\n  }, {\n    key: 'onChange',\n    value: function onChange() {\n\n      if (this.isSearching) return;\n      this.isSearching = true;\n\n      var text = this.searchInput.value;\n      var urlObj = this.validateUrl(text);\n      if (!urlObj) {\n        // Maybe show some message ?\n        return;\n      }\n\n      this.searchText = text;\n      switch (urlObj.type) {\n        case 'video':\n          this.getVideo(this.searchText);\n          break;\n\n        case 'playlist':\n          this.getPlaylist(this.searchText);\n          break;\n\n        default:\n          return;\n      }\n    }\n  }, {\n    key: 'getPlaylist',\n    value: function getPlaylist(url) {\n      console.log('get playlist');\n    }\n  }, {\n    key: 'getVideo',\n    value: function getVideo(url) {\n      console.log('get video');\n    }\n  }, {\n    key: 'validateUrl',\n    value: function validateUrl(url) {\n\n      console.log(url.indexOf('https://www.youtube.com/watch'));\n\n      if (url.indexOf('https://www.youtube.com/watch') === 0) {\n        var video_id = this.getParamByNameFromUrlString('v', url);\n        if (video_id.length !== 11) return false;\n\n        return {\n          id: video_id,\n          type: 'video',\n          url: url\n        };\n      }\n\n      if (url.indexOf('https://www.youtube.com/playlist') === 0) {\n        console.log('play');\n        var _video_id = this.getParamByNameFromUrlString('list', url);\n\n        if (_video_id.length) return false;\n\n        return {\n          id: _video_id,\n          type: 'playlist',\n          url: url\n        };\n      }\n\n      return false;\n    }\n  }, {\n    key: 'getParamByNameFromUrlString',\n    value: function getParamByNameFromUrlString(name, url) {\n      name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n      var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n          results = regex.exec(url);\n      if (!results) return null;\n      if (!results[2]) return '';\n      return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n    }\n  }]);\n\n  return Search;\n}();\n\nexports.default = Search;\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHNcXHNjcmlwdHNcXGFwcC5qcyIsImFzc2V0c1xcc2NyaXB0c1xcbW9kdWxlc1xcc2VhcmNoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7Ozs7QUFFQTs7Ozs7Ozs7SUFFTSxHO0FBQ0osaUJBQWM7QUFBQTs7QUFDWixTQUFLLFlBQUw7QUFDQSxTQUFLLE1BQUwsR0FBYyxzQkFBZDtBQUNEOzs7O21DQUVjO0FBQ2I7QUFDRDs7Ozs7O0FBR0gsSUFBSSxHQUFKOzs7QUNmQTs7Ozs7Ozs7OztJQUVNLE07QUFFSixvQkFBZTtBQUFBOztBQUNiLFNBQUssVUFBTCxHQUFrQixFQUFsQjtBQUNBLFNBQUssV0FBTCxHQUFtQixTQUFTLGFBQVQsQ0FBdUIsMEJBQXZCLENBQW5CO0FBQ0EsU0FBSyxZQUFMLEdBQW9CLFNBQVMsYUFBVCxDQUF1QixvQkFBdkIsQ0FBcEI7O0FBRUEsU0FBSyxLQUFMLEdBQWEsRUFBYjtBQUNBLFNBQUssV0FBTCxHQUFtQixLQUFuQjs7QUFFQSxTQUFLLFFBQUwsR0FBZ0IsS0FBSyxRQUFMLENBQWMsSUFBZCxDQUFtQixJQUFuQixDQUFoQjtBQUNBLFNBQUssV0FBTCxHQUFtQixLQUFLLFdBQUwsQ0FBaUIsSUFBakIsQ0FBc0IsSUFBdEIsQ0FBbkI7QUFDQSxTQUFLLFFBQUwsR0FBZ0IsS0FBSyxRQUFMLENBQWMsSUFBZCxDQUFtQixJQUFuQixDQUFoQjtBQUNBLFNBQUssV0FBTCxHQUFtQixLQUFLLFdBQUwsQ0FBaUIsSUFBakIsQ0FBc0IsSUFBdEIsQ0FBbkI7O0FBRUEsU0FBSyxZQUFMO0FBQ0Q7Ozs7bUNBRWU7QUFDZCxXQUFLLFdBQUwsQ0FBaUIsZ0JBQWpCLENBQWtDLE9BQWxDLEVBQTJDLEtBQUssUUFBaEQ7QUFDQSxXQUFLLFlBQUwsQ0FBa0IsZ0JBQWxCLENBQW1DLE9BQW5DLEVBQTRDLEtBQUssUUFBakQ7QUFDRDs7OytCQUVXOztBQUVWLFVBQUssS0FBSyxXQUFWLEVBQXdCO0FBQ3hCLFdBQUssV0FBTCxHQUFtQixJQUFuQjs7QUFFQSxVQUFNLE9BQU8sS0FBSyxXQUFMLENBQWlCLEtBQTlCO0FBQ0EsVUFBTSxTQUFTLEtBQUssV0FBTCxDQUFpQixJQUFqQixDQUFmO0FBQ0EsVUFBSyxDQUFDLE1BQU4sRUFBZTtBQUNiO0FBQ0E7QUFDRDs7QUFFRCxXQUFLLFVBQUwsR0FBa0IsSUFBbEI7QUFDQSxjQUFTLE9BQU8sSUFBaEI7QUFDRSxhQUFLLE9BQUw7QUFDRSxlQUFLLFFBQUwsQ0FBYyxLQUFLLFVBQW5CO0FBQ0E7O0FBRUYsYUFBSyxVQUFMO0FBQ0UsZUFBSyxXQUFMLENBQWlCLEtBQUssVUFBdEI7QUFDQTs7QUFFRjtBQUFTO0FBVFg7QUFXRDs7O2dDQUVXLEcsRUFBSztBQUNmLGNBQVEsR0FBUixDQUFZLGNBQVo7QUFDRDs7OzZCQUVRLEcsRUFBSztBQUNaLGNBQVEsR0FBUixDQUFZLFdBQVo7QUFDRDs7O2dDQUVXLEcsRUFBSzs7QUFFZixjQUFRLEdBQVIsQ0FBWSxJQUFJLE9BQUosQ0FBWSwrQkFBWixDQUFaOztBQUVBLFVBQUssSUFBSSxPQUFKLENBQVksK0JBQVosTUFBaUQsQ0FBdEQsRUFBMEQ7QUFDeEQsWUFBSSxXQUFXLEtBQUssMkJBQUwsQ0FBaUMsR0FBakMsRUFBc0MsR0FBdEMsQ0FBZjtBQUNBLFlBQUssU0FBUyxNQUFULEtBQW9CLEVBQXpCLEVBQThCLE9BQU8sS0FBUDs7QUFFOUIsZUFBTztBQUNMLGNBQUksUUFEQztBQUVMLGdCQUFNLE9BRkQ7QUFHTCxlQUFLO0FBSEEsU0FBUDtBQUtEOztBQUVELFVBQUssSUFBSSxPQUFKLENBQVksa0NBQVosTUFBb0QsQ0FBekQsRUFBNkQ7QUFDM0QsZ0JBQVEsR0FBUixDQUFZLE1BQVo7QUFDQSxZQUFJLFlBQVcsS0FBSywyQkFBTCxDQUFpQyxNQUFqQyxFQUF5QyxHQUF6QyxDQUFmOztBQUVBLFlBQUssVUFBUyxNQUFkLEVBQXVCLE9BQU8sS0FBUDs7QUFFdkIsZUFBTztBQUNMLGNBQUksU0FEQztBQUVMLGdCQUFNLFVBRkQ7QUFHTCxlQUFLO0FBSEEsU0FBUDtBQUtEOztBQUVELGFBQU8sS0FBUDtBQUNEOzs7Z0RBRTJCLEksRUFBTSxHLEVBQUs7QUFDckMsYUFBTyxLQUFLLE9BQUwsQ0FBYSxTQUFiLEVBQXdCLE1BQXhCLENBQVA7QUFDQSxVQUFJLFFBQVEsSUFBSSxNQUFKLENBQVcsU0FBUyxJQUFULEdBQWdCLG1CQUEzQixDQUFaO0FBQUEsVUFDRSxVQUFVLE1BQU0sSUFBTixDQUFXLEdBQVgsQ0FEWjtBQUVBLFVBQUksQ0FBQyxPQUFMLEVBQWMsT0FBTyxJQUFQO0FBQ2QsVUFBSSxDQUFDLFFBQVEsQ0FBUixDQUFMLEVBQWlCLE9BQU8sRUFBUDtBQUNqQixhQUFPLG1CQUFtQixRQUFRLENBQVIsRUFBVyxPQUFYLENBQW1CLEtBQW5CLEVBQTBCLEdBQTFCLENBQW5CLENBQVA7QUFDRDs7Ozs7O2tCQUdZLE0iLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnXHJcblxyXG5pbXBvcnQgU2VhcmNoIGZyb20gJy4vbW9kdWxlcy9zZWFyY2gnO1xyXG5cclxuY2xhc3MgQXBwIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuaW5pdE1hdGVyaWFsKCk7XHJcbiAgICB0aGlzLnNlYXJjaCA9IG5ldyBTZWFyY2goKTtcclxuICB9XHJcblxyXG4gIGluaXRNYXRlcmlhbCgpIHtcclxuICAgIC8vcmV0dXJuICQubWF0ZXJpYWwuaW5pdCgpO1xyXG4gIH1cclxufVxyXG5cclxubmV3IEFwcCgpO1xyXG5cclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuY2xhc3MgU2VhcmNoXHJcbntcclxuICBjb25zdHJ1Y3RvciAoKSB7XHJcbiAgICB0aGlzLnNlYXJjaFRleHQgPSAnJztcclxuICAgIHRoaXMuc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtc2VhcmNoYm94X190ZXh0ZmllbGQnKTtcclxuICAgIHRoaXMuc2VhcmNoQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLXNlYXJjaF9fYnV0dG9uJyk7XHJcblxyXG4gICAgdGhpcy5zdGF0ZSA9IHt9O1xyXG4gICAgdGhpcy5pc1NlYXJjaGluZyA9IGZhbHNlO1xyXG5cclxuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmdldFBsYXlsaXN0ID0gdGhpcy5nZXRQbGF5bGlzdC5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5nZXRWaWRlbyA9IHRoaXMuZ2V0VmlkZW8uYmluZCh0aGlzKTtcclxuICAgIHRoaXMudmFsaWRhdGVVcmwgPSB0aGlzLnZhbGlkYXRlVXJsLmJpbmQodGhpcyk7XHJcblxyXG4gICAgdGhpcy5hdHRhY2hFdmVudHMoKTtcclxuICB9XHJcblxyXG4gIGF0dGFjaEV2ZW50cyAoKSB7XHJcbiAgICB0aGlzLnNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5vbkNoYW5nZSk7XHJcbiAgICB0aGlzLnNlYXJjaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DaGFuZ2UpO1xyXG4gIH1cclxuXHJcbiAgb25DaGFuZ2UgKCkge1xyXG5cclxuICAgIGlmICggdGhpcy5pc1NlYXJjaGluZyApIHJldHVybjtcclxuICAgIHRoaXMuaXNTZWFyY2hpbmcgPSB0cnVlO1xyXG5cclxuICAgIGNvbnN0IHRleHQgPSB0aGlzLnNlYXJjaElucHV0LnZhbHVlO1xyXG4gICAgY29uc3QgdXJsT2JqID0gdGhpcy52YWxpZGF0ZVVybCh0ZXh0KTtcclxuICAgIGlmICggIXVybE9iaiApIHtcclxuICAgICAgLy8gTWF5YmUgc2hvdyBzb21lIG1lc3NhZ2UgP1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5zZWFyY2hUZXh0ID0gdGV4dDtcclxuICAgIHN3aXRjaCAoIHVybE9iai50eXBlICkge1xyXG4gICAgICBjYXNlICd2aWRlbyc6XHJcbiAgICAgICAgdGhpcy5nZXRWaWRlbyh0aGlzLnNlYXJjaFRleHQpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAncGxheWxpc3QnOlxyXG4gICAgICAgIHRoaXMuZ2V0UGxheWxpc3QodGhpcy5zZWFyY2hUZXh0KTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGRlZmF1bHQ6IHJldHVybjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldFBsYXlsaXN0KHVybCkge1xyXG4gICAgY29uc29sZS5sb2coJ2dldCBwbGF5bGlzdCcpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlkZW8odXJsKSB7XHJcbiAgICBjb25zb2xlLmxvZygnZ2V0IHZpZGVvJyk7XHJcbiAgfVxyXG5cclxuICB2YWxpZGF0ZVVybCh1cmwpIHtcclxuXHJcbiAgICBjb25zb2xlLmxvZyh1cmwuaW5kZXhPZignaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2gnKSk7XHJcblxyXG4gICAgaWYgKCB1cmwuaW5kZXhPZignaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2gnKSA9PT0gMCApIHtcclxuICAgICAgbGV0IHZpZGVvX2lkID0gdGhpcy5nZXRQYXJhbUJ5TmFtZUZyb21VcmxTdHJpbmcoJ3YnLCB1cmwpO1xyXG4gICAgICBpZiAoIHZpZGVvX2lkLmxlbmd0aCAhPT0gMTEgKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiB2aWRlb19pZCxcclxuICAgICAgICB0eXBlOiAndmlkZW8nLFxyXG4gICAgICAgIHVybDogdXJsXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoIHVybC5pbmRleE9mKCdodHRwczovL3d3dy55b3V0dWJlLmNvbS9wbGF5bGlzdCcpID09PSAwICkge1xyXG4gICAgICBjb25zb2xlLmxvZygncGxheScpO1xyXG4gICAgICBsZXQgdmlkZW9faWQgPSB0aGlzLmdldFBhcmFtQnlOYW1lRnJvbVVybFN0cmluZygnbGlzdCcsIHVybCk7XHJcblxyXG4gICAgICBpZiAoIHZpZGVvX2lkLmxlbmd0aCApIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaWQ6IHZpZGVvX2lkLFxyXG4gICAgICAgIHR5cGU6ICdwbGF5bGlzdCcsXHJcbiAgICAgICAgdXJsOiB1cmwsXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBnZXRQYXJhbUJ5TmFtZUZyb21VcmxTdHJpbmcobmFtZSwgdXJsKSB7XHJcbiAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCBcIlxcXFwkJlwiKTtcclxuICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJbPyZdXCIgKyBuYW1lICsgXCIoPShbXiYjXSopfCZ8I3wkKVwiKSxcclxuICAgICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcclxuICAgIGlmICghcmVzdWx0cykgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAoIXJlc3VsdHNbMl0pIHJldHVybiAnJztcclxuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgXCIgXCIpKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlYXJjaDsiXX0=\n"]}